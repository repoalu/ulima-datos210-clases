DROP TABLE PEDIDO;
DROP TABLE CLIENTE;
DROP TABLE PRODUCTO;
--CREATE TABLE <NOMBRE_TABLA>
CREATE TABLE CLIENTE(
    --NOMBRE_CAMPO TIPO_DATO (INTEGER, NUMBER, VARCHAR2, DATE)
    CODIGO INTEGER PRIMARY KEY,
    NOMBRE VARCHAR2(100), --TAMANO MAXIMO: 100
    DNI VARCHAR2(8),
    CIUDAD VARCHAR2(30)
);

--AGREGAR DATOS A LA TABLA:
--INSERT INTO <NOMBRE_TABLA> VALUES (<VALOR_AT1>, <VALOR_AT2>, ..... );
INSERT INTO CLIENTE VALUES(1, 'JORGE PARDO', '75858699', 'LIMA');
INSERT INTO CLIENTE VALUES(2, 'CESAR ALVARADO', '45852658', 'LIMA');
INSERT INTO CLIENTE VALUES(3, 'MARIANA VILCHEZ', '56747577', 'AREQUIPA');

--CONSULTAR DATOS DE UNA TABLA: 
--SELECT <CAMPOS / *> FROM <TABLA>
SELECT * FROM CLIENTE;

--MOSTRAR ALGUNOS CAMPOS (PROYECCION)
SELECT NOMBRE, DNI FROM CLIENTE;

--REALIZAR FILTROS (SELECCION)
--SELECT <CAMPOS / *> FROM TABLA WHERE <CONDICION>
SELECT * FROM CLIENTE WHERE CIUDAD = 'LIMA'; 

--SELECCION Y PROYECCION
SELECT NOMBRE, DNI FROM CLIENTE WHERE CODIGO = 3;


--CREACION DE TABLA
CREATE TABLE PRODUCTO(
    CODIGO INTEGER PRIMARY KEY,
    NOMBRE VARCHAR2(50),
    DESCRIPCION VARCHAR2(100),
    PRECIO_UNITARIO NUMBER(5, 2)
);

INSERT INTO PRODUCTO VALUES(1, 'GASEOSA 500ML X', 'BOTELLA DE GASEOSA', 2.5);
INSERT INTO PRODUCTO VALUES(2, 'TARRO DE LECHE Y', 'TARRO DE LECHA', 3.1);
INSERT INTO PRODUCTO VALUES(3, 'CARAMELO LIMON Z', 'CARAMELO DE LIMON', 0.2);
INSERT INTO PRODUCTO VALUES(4, 'DETERGENTE 10KG', 'DETERGENTE GRANDE', 12.4);
INSERT INTO PRODUCTO VALUES(5, 'ARROZ 5 KG', 'BOLSA GRANDE DE ARROZ', 15.25);


CREATE TABLE PEDIDO(
    CODIGO INTEGER PRIMARY KEY,
    FECHA DATE,
    COD_CLIENTE REFERENCES CLIENTE
);


INSERT INTO PEDIDO VALUES(120, SYSDATE, 2);
INSERT INTO PEDIDO VALUES(155, SYSDATE, 2);
INSERT INTO PEDIDO VALUES(380, SYSDATE, 1);

--CODIGO DEL PEDIDO Y NOMBRE DEL CLIENTE AL QUE PERTENECE
SELECT PE.CODIGO, C.NOMBRE
FROM CLIENTE C, PEDIDO PE
WHERE C.CODIGO = PE.COD_CLIENTE;

--CREAMOS TABLA ITEM
CREATE TABLE ITEM(
    COD_PEDIDO REFERENCES PEDIDO,
    COD_PRODUCTO REFERENCES PRODUCTO,
    CANTIDAD INTEGER,
    PRIMARY KEY(COD_PEDIDO, COD_PRODUCTO)
);

INSERT INTO ITEM VALUES(120, 1, 4);
INSERT INTO ITEM VALUES(120, 2, 6);
INSERT INTO ITEM VALUES(155, 1, 12);
INSERT INTO ITEM VALUES(155, 2, 3);
INSERT INTO ITEM VALUES(155, 3, 20);
INSERT INTO ITEM VALUES(155, 4, 3);
INSERT INTO ITEM VALUES(380, 2, 8);
INSERT INTO ITEM VALUES(380, 4, 5);

--CODIGO DE PRODUCTO Y CANTIDAD PARA CADA COMPONENTE DEL PEDIDO 380
SELECT COD_PRODUCTO, CANTIDAD FROM ITEM WHERE COD_PEDIDO = 380;

--NOMBRE DE PRODUCTO Y CANTIDAD PARA CADA COMPONENTE DEL PEDIDO 155
SELECT P.NOMBRE, I.CANTIDAD--CAMPOS
FROM ITEM I, PRODUCTO P --<TABLAS>
WHERE P.CODIGO = I.COD_PRODUCTO --<CONDICION DE JOIN>
--<CONDICIONES ADICIONALES>
AND I.COD_PEDIDO = 155;

--NOMBRE DE CLIENTE, CODIGO DE PEDIDO, NOMBRE DE LOS PRODUCTOS Y CANTIDADES 
--PARA TODOS LOS PEDIDOS DEL CLIENTE CON DNI = "45852658"

--<CAMPOS>
SELECT  C.NOMBRE, PE.CODIGO, P.NOMBRE, I.CANTIDAD,
        P.PRECIO_UNITARIO, P.PRECIO_UNITARIO * I.CANTIDAD AS TOTAL
--<TABLAS>
FROM CLIENTE C, PRODUCTO P, PEDIDO PE, ITEM I
--<CONDICIONES DE JOIN>
WHERE C.CODIGO = PE.COD_CLIENTE
AND PE.CODIGO = I.COD_PEDIDO
AND I.COD_PRODUCTO = P.CODIGO
--<CONDICIONES ADICIONALES>
AND C.DNI = '45852658'
ORDER BY PE.CODIGO;

SELECT  SUM(P.PRECIO_UNITARIO * I.CANTIDAD) AS TOTAL
--<TABLAS>
FROM CLIENTE C, PRODUCTO P, PEDIDO PE, ITEM I
--<CONDICIONES DE JOIN>
WHERE C.CODIGO = PE.COD_CLIENTE
AND PE.CODIGO = I.COD_PEDIDO
AND I.COD_PRODUCTO = P.CODIGO
--<CONDICIONES ADICIONALES>
AND C.DNI = '45852658';

/*
ACTUALIZACION DE DATOS: SENTENCIA UPDATE
UPDATE <NOMBRE_TABLA> SET <CAMPO1> = <VALOR1>, <CAMPO2> = <VALOR2>, ....
WHERE <CONDICIONES>
*/

-- ACTUALICE LA INFORMACION PARA CONSIDERAR 8 UNIDADES DE PRODUCTO 2 PARA EL PEDIDO 120.
UPDATE ITEM 
SET CANTIDAD = 8
WHERE COD_PEDIDO = 120 AND COD_PRODUCTO = 2;

--COMPROBAR RESULTADOS
SELECT * FROM ITEM
WHERE COD_PEDIDO = 120 AND COD_PRODUCTO = 2;


--ACTUALICE LA INFORMACION DEL CLIENTE CESAR ALVARADO PARA CONSIDERAR "TUMBRES" COMO SU CIUDAD
UPDATE CLIENTE
SET CIUDAD = 'TUMBES'
WHERE NOMBRE = 'CESAR ALVARADO';

--COMPROBAR RESULTADOS
SELECT * FROM CLIENTE
WHERE NOMBRE = 'CESAR ALVARADO';

/*
ELIMINACION DE REGISTROS: SENTENCIA DELETE
DELETE FROM <NOMBRE_TABLA> WHERE <CONDICION>
*/

--ELIMINAR AL CLIENTE DE CODIGO 3
DELETE FROM CLIENTE WHERE CODIGO = 3;

--COMPROBA RESULTADOS
SELECT * FROM CLIENTE;


/*
AGREGAR UN CAMPO A UNA TABLA
ALTER TABLE <NOMBRE_TABLA> ADD <NOMBRE_CAMPO> <TIPO_DATO> [RESTRICCIONES]
*/
ALTER TABLE CLIENTE ADD DIRECCION VARCHAR2(20);

--COMPROBAMOS ADICION DE LA COLUMNA
SELECT * FROM CLIENTE;

/*
MODIFICAR UN CAMPO DE UNA TABLA (POR EJEMPLO, SU TIPO DE DATO)

ALTER TABLE <NOMBRE_TABLA> MODIFY <NOMBRE_CAMPO> <TIPO_DATO> [RESTRICCIONES]
*/
ALTER TABLE CLIENTE MODIFY DIRECCION VARCHAR2(200);


/*ELIMINAR UN CAMPO DE UNA TABLA
ALTER TABLE <NOMBRE_TABLA> DROP COLUMN <NOMBRE_CAMPO>
*/
ALTER TABLE CLIENTE DROP COLUMN DIRECCION;

--COMPROBAMOS RESULTADOS
SELECT * FROM CLIENTE;


